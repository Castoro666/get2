{% extends "base.html" %}
{% load static %}
{% block head %}
<link type="text/css" href="{% static "Aristo/Aristo.css" %}" rel="stylesheet" />
<script type="text/javascript" src="{% static "jquery-ui.js" %}"></script>
{% endblock %}

{% block menu2 %}
<ul>
<li class="aggiungi staff"><a href="/utenti/nuovo">Nuovo Utente</a></li>
</ul>

<div id="navigazione">
<div class="nav-solo nav"><span class="utenti-nav"> Utenti</span></div>
</div>

{% endblock %}


{% block main %}

<script type="text/javascript">
function utente_persona(selettore){
	value=selettore.options[selettore.selectedIndex].value;
	dati=value.split("/");
	Dajaxice.get2.calendario.utente_persona(Dajax.process,{'user_id':dati[0],'persona_id':dati[1]});
}

function utente_staff(selettore){
	value=selettore.value;
	Dajaxice.get2.calendario.utente_staff(Dajax.process,{'user_id':value});
}

</script>

{% for utente in utenti %}

<script type="text/javascript">
$(document).ready(function(){

var s = document.getElementById('{{utente.id}}');
if('{{utente.get_profile.id}}'!=''){
	for (var i=0 ; i < s.length; i++)
		if (s.options[i].text=='{{utente.get_profile}}')
			s.selectedIndex = i;
}
$( "a", ".operazioni" ).button();


return true;
})
</script>
	<div class="utente riga" id="utente-{{utente.id}}">
	<div class="login col">{{utente}}</div>
	<div class="mail col">{{utente.email}}</div>
	<div class="persona col">
		<SELECT NAME="stato"  ONCHANGE="utente_persona(this)" id="{{utente.id}}">
		<OPTION VALUE="{{utente.id}}/n">Nessuno
		{% for persona in persone %}
		<OPTION VALUE="{{utente.id}}/{{persona.id}}">{{persona}}
		{% endfor %}
		</SELECT>
	</div>
	<div class="staff col">{%if not utente.is_superuser%}
 		<input id="staff-{{utente.id}}" type="checkbox" value="{{utente.id}}" ONCHANGE="utente_staff(this);" 
		{%if utente.is_staff%}checked="true"{%endif%}/>{%else%} superuser {%endif%}</div>
	<div class="operazioni col"><a href="/utente/modifica/{{utente.id}}/"> modifica </a>
		<a href="/utente/modifica/{{utente.id}}/password" > modifica password </a>
		<a href="#" onclick='$("#elimina-utente-{{utente.id}}" ).dialog("open");'>elimina</a></div>
	</div>
	<script>
	$(function() {
		$( "#elimina-utente-{{utente.id}}" ).dialog({
			resizable: false,
			modal: true,
			autoOpen: false,
			buttons: {
				"Elimina": function() {
					Dajaxice.get2.calendario.elimina_utente(Dajax.process,{'utente_id':{{utente.id}}});
					$( this ).dialog( "close" );
				},
				Cancel: function() {
					$( this ).dialog( "close" );
				}
			}
		});
	});
	
	</script>
	<div id="elimina-utente-{{utente.id}}" title="Elimina {{utente}}">
	<p>
		<span class="ui-icon ui-icon-alert" style="float:left; margin:0 7px 50px 0;"></span>Vuoi veramente eliminare l' utente {{utente}}?
	</p>
	</div>

{% endfor %}



{% endblock %}
